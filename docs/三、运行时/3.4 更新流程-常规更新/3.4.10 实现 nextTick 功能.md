# 3.4.10 实现 nextTick 功能

`nextTick` 本质上就是把一个函数扔到微任务队列里去执行

你可以把它理解为一个**插队工具**（具体可以去学习一下事件循环）：

- **同步代码**：还在排队买票，必须马上做。
- **nextTick (微任务)**：**买完票后，在进场（浏览器渲染）之前**，赶紧去上个厕所。
- **setTimeout (宏任务)**：进场看完电影（渲染完成）之后，再去吃饭

构建了一个机制，让我们显式地告诉程序：“**请把这行代码，安排在当前这一轮事情做完之后，但在下一轮渲染开始之前执行。**

## 实现

利用Promise 的微任务（Microtask）特性：**Promise.then(fn), 会将fn放入微任务队列里面**

```jsx
//packages\runtime-core\src\scheduler.ts
// 直接Promise.resolve()，then(fn) 控制fn进入微队列
const p = Promise.resolve()
export function nextTick(fn?: () => void) {
    //  p.then(fn) 将fn放入到微队列中
    return fn ? p.then(fn) : p
}
```